<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Determine the best-fit parameters for a specific 2D-Gaussian model — fit_gaussian_2D • gaussplotR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Determine the best-fit parameters for a specific 2D-Gaussian model — fit_gaussian_2D" />
<meta property="og:description" content="Determine the best-fit parameters for a specific 2D-Gaussian model" />
<meta property="og:image" content="https://vbaliga.github.io/gaussplotR/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gaussplotR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fit_gaussian_2D.html">Fitting 2D Gaussians to data</a>
    </li>
    <li>
      <a href="../articles/formulas-used-by-fit-gaussian-2D.html">Formulas used by fit_gaussian_2D</a>
    </li>
    <li>
      <a href="../articles/troubleshooting-model-fits.html">Troubleshooting model fits</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vbaliga/gaussplotR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Determine the best-fit parameters for a specific 2D-Gaussian model</h1>
    <small class="dont-index">Source: <a href='https://github.com/vbaliga/gaussplotR/blob/master/R/fit_gaussian_2D.R'><code>R/fit_gaussian_2D.R</code></a></small>
    <div class="hidden name"><code>fit_gaussian_2D.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Determine the best-fit parameters for a specific 2D-Gaussian model</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/fit_gaussian_2D.html'>fit_gaussian_2D</a></span>(
  <span class='kw'>data</span>,
  method = <span class='st'>"elliptical"</span>,
  constrain_amplitude = <span class='fl'>FALSE</span>,
  constrain_orientation = <span class='st'>"unconstrained"</span>,
  user_init = <span class='kw'>NULL</span>,
  maxiter = <span class='fl'>1000</span>,
  verbose = <span class='fl'>FALSE</span>,
  print_initial_params = <span class='fl'>FALSE</span>,
  <span class='kw'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data.frame that contains the raw data (generally rectilinearly
gridded data, but this is not a strict requirement). Columns must be named
<code>"X_values"</code>, <code>"Y_values"</code> and <code>"response"</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Choice of <code>"elliptical"</code>, <code>"elliptical_log"</code>, or
<code>"circular"</code>. Determine which specific implementation of 2D-Gaussian
to use. See Details for more.</p></td>
    </tr>
    <tr>
      <th>constrain_amplitude</th>
      <td><p>Default FALSE; should the amplitude of the
Gaussian be set to the maximum value of the <code>"response"</code> variable
(<code>TRUE</code>), or should the amplitude fitted by <code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code>
(<code>FALSE</code>)?</p></td>
    </tr>
    <tr>
      <th>constrain_orientation</th>
      <td><p>If using <code>"elliptical"</code> or <code>method =
  "elliptical_log"</code>, should the orientation of the Gaussian be unconstrained
(i.e. the best-fit orientation is returned) or should it be pre-set by the
user? See Details for more. Defaults to <code>"unconstrained"</code>.</p></td>
    </tr>
    <tr>
      <th>user_init</th>
      <td><p>Default NULL; if desired, the user can supply initial values
for the parameters of the chosen model. See Details for more.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>Default 1000. A positive integer specifying the maximum number
of iterations allowed. See <code><a href='https://rdrr.io/r/stats/nls.control.html'>stats::nls.control()</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>TRUE or FALSE; should the trace of the iteration be printed?
See the <code>trace</code> argument of <code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code> for more detail.</p></td>
    </tr>
    <tr>
      <th>print_initial_params</th>
      <td><p>TRUE or FALSE; should the set of initial
parameters supplied to <code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code> be printed to the console? Set
to FALSE by default to avoid confusion with the fitted parameters attained
after using <code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='https://rdrr.io/r/stats/nls.control.html'>stats::nls.control()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the components:</p><ul>
<li><p>"coefs" A data.frame of fitted model parameters.</p></li>
<li><p>"model" The model object, fitted by <code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code>.</p></li>
<li><p>"model_error_stats" A data.frame detailing the rss, rmse, deviance,
and AIC of the fitted model.</p></li>
<li><p>"fit_method" A character vector that indicates which method and
orientation strategy was used by this function.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code> is used to fit parameters for a 2D-Gaussian to
the supplied data. Each method uses (slightly) different sets of
parameters. Note that for a small (but non-trivial) proportion of data
sets, nonlinear least squares may fail due to singularities or other
issues. Most often, this occurs because of the starting parameters that are
fed in. By default, this function attempts to set default parameters by
making an educated guess about the major aspects of the supplied data.
Should this strategy fail, the user can make use of the <code>user_init</code>
argument to supply an alternate set of starting values.</p>
<p>The simplest method is <code>method = "circular"</code>. Here, the 2D-Gaussian is
constrained to have a roughly circular shape (i.e. spread in X- and Y- are
roughly equal). If this method is used, the fitted parameters are: Amp
(amplitude), X_peak (x-axis peak location), Y_peak (y-axis peak location),
X_sig (spread along x-axis), and Y_sig (spread along y-axis).</p>
<p>A more generic method (and the default) is <code>method = "elliptical"</code>.
This allows the fitted 2D-Gaussian to take a more ellipsoid shape (but note
that <code>method = "circular"</code> can be considered a special case of this).
If this method is used, the fitted parameters are: A_o (a constant term),
Amp (amplitude), theta (rotation, in radians, from the x-axis in the
clockwise direction), X_peak (x-axis peak location), Y_peak (y-axis peak
location), a (width of Gaussian along x-axis), and b (width of Gaussian
along y-axis).</p>
<p>A third method is <code>method = "elliptical_log"</code>. This is a further
special case in which log2-transformed data may be used. See Priebe et al.
2003 for more details. Parameters from this model include: Amp (amplitude),
Q (orientation parameter), X_peak (x-axis peak location), Y_peak (y-axis
peak location), X_sig (spread along x-axis), and Y_sig (spread along
y-axis).</p>
<p>If using either <code>method = "elliptical"</code> or <code>method =
  "elliptical_log"</code>, the <code>"constrain_orientation"</code> argument can be used
to specify how the orientation is set. In most cases, the user should use
the default "unconstrained" setting for this argument. Doing so will
provide the best-fit 2D-Gaussian (assuming that the solution yielded by
<code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code> converges on the global optimum).</p>
<p>Setting <code>constrain_orientation</code> to a numeric (e.g.
<code>constrain_orientation = pi/2</code>) will force the orientation of the
Gaussian to the specified value. Note that this is handled differently by
<code>method = "elliptical"</code> vs <code>method = "elliptical_log"</code>. In
<code>method = "elliptical"</code>, the theta parameter dictates the rotation, in
radians, from the x-axis in the clockwise direction. In contrast, the
<code>method = "elliptical_log"</code> procedure uses a Q parameter to determine
the orientation of the 2D-Gaussian. Setting <code>constrain_orientation =
  0</code> will result in a diagonally-oriented Gaussian, whereas setting
<code>constrain_orientation = -1</code> will result in horizontal orientation.
See Priebe et al. 2003 for more details.</p>
<p>The <code>user_init</code> argument can also be used to supply a vector of
initial values for the A, Q, X_peak, Y_peak, X_var, and Y_var parameters.
If the user chooses to make use of <code>user_init</code>, then a vector
containing all parameters must be supplied in a particular order.</p>
<p>Additional arguments to the <code>control</code> argument in <code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code>
can be supplied via <code>...</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Priebe NJ, Cassanello CR, Lisberger SG. The neural representation
of speed in macaque area MT/V5. J Neurosci. 2003 Jul 2;23(13):5650-61. doi:
10.1523/JNEUROSCI.23-13-05650.2003.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Vikram B. Baliga</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span>()) {
  <span class='co'>## Load the sample data set</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>gaussplot_sample_data</span>)

  <span class='co'>## The raw data we'd like to use are in columns 1:3</span>
  <span class='kw'>samp_dat</span> <span class='op'>&lt;-</span>
    <span class='kw'>gaussplot_sample_data</span>[,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>]


  <span class='co'>#### Example 1: Unconstrained elliptical ####</span>
  <span class='co'>## This fits an unconstrained elliptical by default</span>
  <span class='kw'>gauss_fit</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/fit_gaussian_2D.html'>fit_gaussian_2D</a></span>(<span class='kw'>samp_dat</span>)

  <span class='co'>## Generate a grid of x- and y- values on which to predict</span>
  <span class='kw'>grid</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(X_values = <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(from = <span class='op'>-</span><span class='fl'>5</span>, to = <span class='fl'>0</span>, by = <span class='fl'>0.1</span>),
                Y_values = <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(from = <span class='op'>-</span><span class='fl'>1</span>, to = <span class='fl'>4</span>, by = <span class='fl'>0.1</span>))

  <span class='co'>## Predict the values using predict_gaussian_2D</span>
  <span class='kw'>gauss_data</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/predict_gaussian_2D.html'>predict_gaussian_2D</a></span>(
      fit_object = <span class='kw'>gauss_fit</span>,
      X_values = <span class='kw'>grid</span><span class='op'>$</span><span class='kw'>X_values</span>,
      Y_values = <span class='kw'>grid</span><span class='op'>$</span><span class='kw'>Y_values</span>,
    )

  <span class='co'>## Plot via ggplot2 and metR</span>
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'><a href='http://ggplot2.tidyverse.org'>ggplot2</a></span>); <span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'><a href='https://github.com/eliocamp/metR'>metR</a></span>)
  <span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/ggplot_gaussian_2D.html'>ggplot_gaussian_2D</a></span>(<span class='kw'>gauss_data</span>)

  <span class='co'>## Produce a 3D plot via rgl</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/rgl_gaussian_2D.html'>rgl_gaussian_2D</a></span>(<span class='kw'>gauss_data</span>)


  <span class='co'>#### Example 2: Constrained elliptical_log ####</span>
  <span class='co'>## This fits a constrained elliptical, as in Priebe et al. 2003</span>
  <span class='kw'>gauss_fit</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/fit_gaussian_2D.html'>fit_gaussian_2D</a></span>(
      <span class='kw'>samp_dat</span>,
      method = <span class='st'>"elliptical_log"</span>,
      constrain_orientation = <span class='op'>-</span><span class='fl'>1</span>
    )

  <span class='co'>## Generate a grid of x- and y- values on which to predict</span>
  <span class='kw'>grid</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(X_values = <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(from = <span class='op'>-</span><span class='fl'>5</span>, to = <span class='fl'>0</span>, by = <span class='fl'>0.1</span>),
                Y_values = <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(from = <span class='op'>-</span><span class='fl'>1</span>, to = <span class='fl'>4</span>, by = <span class='fl'>0.1</span>))

  <span class='co'>## Predict the values using predict_gaussian_2D</span>
  <span class='kw'>gauss_data</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/predict_gaussian_2D.html'>predict_gaussian_2D</a></span>(
      fit_object = <span class='kw'>gauss_fit</span>,
      X_values = <span class='kw'>grid</span><span class='op'>$</span><span class='kw'>X_values</span>,
      Y_values = <span class='kw'>grid</span><span class='op'>$</span><span class='kw'>Y_values</span>,
    )

  <span class='co'>## Plot via ggplot2 and metR</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/ggplot_gaussian_2D.html'>ggplot_gaussian_2D</a></span>(<span class='kw'>gauss_data</span>)

  <span class='co'>## Produce a 3D plot via rgl</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gaussplotR/man/rgl_gaussian_2D.html'>rgl_gaussian_2D</a></span>(<span class='kw'>gauss_data</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.vikram-baliga.com/'>Vikram B. Baliga</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


