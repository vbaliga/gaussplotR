<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Characterize the orientation of fitted 2D-Gaussians — characterize_gaussian_fits • gaussplotR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Characterize the orientation of fitted 2D-Gaussians — characterize_gaussian_fits" />
<meta property="og:description" content="The orientation and partial correlations of Gaussian data are analyzed
according to Levitt et al. 1994 and Priebe et al. 2003. Features include
computation of partial correlations between response variables and
independent and diagonally-tuned predictions, along with Z-difference
scoring." />
<meta property="og:image" content="https://vbaliga.github.io/gaussplotR/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gaussplotR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fit_gaussian_2D.html">Fitting 2D Gaussians to data</a>
    </li>
    <li>
      <a href="../articles/formulas-used-by-fit-gaussian-2D.html">Formulas used by fit_gaussian_2D</a>
    </li>
    <li>
      <a href="../articles/troubleshooting-model-fits.html">Troubleshooting model fits</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vbaliga/gaussplotR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Characterize the orientation of fitted 2D-Gaussians</h1>
    <small class="dont-index">Source: <a href='https://github.com/vbaliga/gaussplotR/blob/master/R/characterize_gaussian_fits.R'><code>R/characterize_gaussian_fits.R</code></a></small>
    <div class="hidden name"><code>characterize_gaussian_fits.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The orientation and partial correlations of Gaussian data are analyzed
according to Levitt et al. 1994 and Priebe et al. 2003. Features include
computation of partial correlations between response variables and
independent and diagonally-tuned predictions, along with Z-difference
scoring.</p>
    </div>

    <pre class="usage"><span class='fu'>characterize_gaussian_fits</span><span class='op'>(</span>
  fit_objects_list <span class='op'>=</span> <span class='cn'>NULL</span>,
  data <span class='op'>=</span> <span class='cn'>NULL</span>,
  constrain_amplitude <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fit_objects_list</th>
      <td><p>A list of outputs from <code><a href='fit_gaussian_2D.html'>fit_gaussian_2D()</a></code>. See
Details for more. This is the preferred input object for this function.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame that contains the raw data (generally rectilinearly
gridded data, but this is not a strict requirement). Columns must be named
<code>"X_values"</code>, <code>"Y_values"</code> and <code>"response"</code>. See
<code><a href='fit_gaussian_2D.html'>fit_gaussian_2D()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>constrain_amplitude</th>
      <td><p>Default FALSE; should the amplitude of the
Gaussian be set to the maximum value of the <code>"response"</code> variable
(<code>TRUE</code>), or should the amplitude fitted by <code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code>
(<code>FALSE</code>)? See <code><a href='fit_gaussian_2D.html'>fit_gaussian_2D()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments that can be passed to
<code><a href='fit_gaussian_2D.html'>fit_gaussian_2D()</a></code> if data are supplied.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following:</p><ul>
<li><p>"model_comparison" A model comparison output (i.e. what is produced
by <code><a href='compare_gaussian_fits.html'>compare_gaussian_fits()</a></code>), which indicates the relative preference
of each of the three models.</p></li>
<li><p>"Q_table" A data.frame that provides information on the value of Q
from the best-fitting model, along with the 5-95% confidence intervals of
this estimate.</p></li>
<li><p>"r_i" A numeric, the correlation of the data with the independent
(Q = -1) prediction.</p></li>
<li><p>"r_s" A numeric, the correlation of the data with the diagonally-
oriented (Q = 0) prediction.</p></li>
<li><p>"r_is" A numeric, the correlation between the independent
(Q = -1) prediction and the the diagonally-oriented (Q = 0) prediction.</p></li>
<li><p>"R_indp" A numeric, partial correlation of the response variable
with the independent (Q = -1) prediction.</p></li>
<li><p>"R_diag" A numeric, partial correlation of the response variable
with the diagonally-oriented (Q = 0) prediction.</p></li>
<li><p>"ZF_indp" A numeric, the Fisher Z-transform of the R_indp
coefficient. See Winship et al. 2006 for details.</p></li>
<li><p>"ZF_diag" A numeric, the Fisher Z-transform of the R_diag
coefficient. See Winship et al. 2006 for details.</p></li>
<li><p>"Z_diff" A numeric, the Z-difference between ZF_indp and ZF_diag.
See Winship et al. 2006 for details.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function accepts either a list of objects output from
<code><a href='fit_gaussian_2D.html'>fit_gaussian_2D()</a></code> (preferred) or a data.frame that contains the raw
data.</p>
<p>The supplied fit_objects_list must be a list that contains objects returned
by <code><a href='fit_gaussian_2D.html'>fit_gaussian_2D()</a></code>. This list must contain exactly three models. All
three models must have been run using <code>method = "elliptical_log"</code>. The
models must be: 1) one in which orientation is unconstrained, 2) one in which
orientation is constrained to Q = 0 (i.e. a diagonally-oriented Gaussian),
and 3) one in which orientation is constrained to Q = -1 (i.e. a
horizontally-oriented Gaussian). See this function's Examples for guidance.</p>
<p>Should raw data be provided instead of the fit_objects_list, the
<code>characterize_gaussian_fits()</code> runs <code><a href='fit_gaussian_2D.html'>fit_gaussian_2D()</a></code> internally.
This is generally not recommended, as difficulties in fitting models via
<code><a href='https://rdrr.io/r/stats/nls.html'>stats::nls()</a></code> are more easily troubleshot by the optional arguments in
<code><a href='fit_gaussian_2D.html'>fit_gaussian_2D()</a></code>. Nevertheless, supplying raw data instead of a list
of fitted models is feasible, though your mileage may vary.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Levitt JB, Kiper DC, Movshon JA. Receptive fields and functional architecture
of macaque V2. J Neurophysiol. 1994 71:2517–2542.</p>
<p>Priebe NJ, Cassanello CR, Lisberger SG. The neural representation of speed in
macaque area MT/V5. J Neurosci. 2003 Jul 2;23(13):5650-61. doi:
10.1523/JNEUROSCI.23-13-05650.2003.</p>
<p>Winship IR, Crowder N, Wylie DRW. Quantitative reassessment of speed tuning
in the accessory optic system and pretectum of pigeons. J Neurophysiol. 2006
95(1):546-551. doi: 10.1152/jn.00921.2005</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Vikram B. Baliga</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/vbaliga/gaussplotR'>gaussplotR</a></span><span class='op'>)</span>

  <span class='co'>## Load the sample data set</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>gaussplot_sample_data</span><span class='op'>)</span>

  <span class='co'>## The raw data we'd like to use are in columns 1:3</span>
  <span class='va'>samp_dat</span> <span class='op'>&lt;-</span>
    <span class='va'>gaussplot_sample_data</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>

  <span class='co'>## Fit the three required models</span>
  <span class='va'>gauss_fit_uncn</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='fit_gaussian_2D.html'>fit_gaussian_2D</a></span><span class='op'>(</span>
      <span class='va'>samp_dat</span>,
      method <span class='op'>=</span> <span class='st'>"elliptical_log"</span>,
      constrain_amplitude <span class='op'>=</span> <span class='cn'>FALSE</span>,
      constrain_orientation <span class='op'>=</span> <span class='st'>"unconstrained"</span>
    <span class='op'>)</span>

  <span class='va'>gauss_fit_diag</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='fit_gaussian_2D.html'>fit_gaussian_2D</a></span><span class='op'>(</span>
      <span class='va'>samp_dat</span>,
      method <span class='op'>=</span> <span class='st'>"elliptical_log"</span>,
      constrain_amplitude <span class='op'>=</span> <span class='cn'>FALSE</span>,
      constrain_orientation <span class='op'>=</span> <span class='fl'>0</span>
    <span class='op'>)</span>

  <span class='va'>gauss_fit_indp</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='fit_gaussian_2D.html'>fit_gaussian_2D</a></span><span class='op'>(</span>
      <span class='va'>samp_dat</span>,
      method <span class='op'>=</span> <span class='st'>"elliptical_log"</span>,
      constrain_amplitude <span class='op'>=</span> <span class='cn'>FALSE</span>,
      constrain_orientation <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>
    <span class='op'>)</span>

  <span class='co'>## Combine the outputs into a list</span>
  <span class='va'>models_list</span> <span class='op'>&lt;-</span>
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
      <span class='va'>gauss_fit_uncn</span>,
      <span class='va'>gauss_fit_diag</span>,
      <span class='va'>gauss_fit_indp</span>
    <span class='op'>)</span>

  <span class='co'>## Now characterize</span>
  <span class='va'>out</span> <span class='op'>&lt;-</span>
    <span class='fu'>characterize_gaussian_fits</span><span class='op'>(</span><span class='va'>models_list</span><span class='op'>)</span>
  <span class='va'>out</span>

  <span class='co'>## Alternatively, the raw data itself can be supplied.</span>
  <span class='co'>## This is less preferred, as fitting of models may fail</span>
  <span class='co'>## internally.</span>
  <span class='va'>out2</span> <span class='op'>&lt;-</span>
    <span class='fu'>characterize_gaussian_fits</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>samp_dat</span><span class='op'>)</span>

  <span class='co'>## This produces the same output, assuming models are fit without error</span>
  <span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='va'>out</span>, <span class='va'>out2</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.vikram-baliga.com/'>Vikram B. Baliga</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


