<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting 2D Gaussians to Data • gaussplotR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting 2D Gaussians to Data">
<meta property="og:description" content="gaussplotR">
<meta property="og:image" content="https://vbaliga.github.io/gaussplotR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gaussplotR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fit_gaussian_2D.html">Fitting 2D Gaussians to Data</a>
    </li>
    <li>
      <a href="../articles/formulas-used-by-fit-gaussian-2D.html">Formulas used by fit_gaussian_2D</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vbaliga/gaussplotR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting 2D Gaussians to Data</h1>
                        <h4 class="author">Vikram B. Baliga</h4>
            
            <h4 class="date">2020-12-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vbaliga/gaussplotR/blob/master/vignettes/fit_gaussian_2D.Rmd"><code>vignettes/fit_gaussian_2D.Rmd</code></a></small>
      <div class="hidden name"><code>fit_gaussian_2D.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The function <code><a href="../reference/fit_gaussian_2D.html">fit_gaussian_2D()</a></code> can be used fit 2D Gaussians to data, and has several methods for how the fitting is implemented. This vignette will run you through what these methods mean with worked examples.</p>
<p>We’ll begin by loading <code>gaussplotR</code> and loading the sample data set provided within. The raw data we’d like to use are in columns 1:3, so we’ll shave the data set down to those columns before running through the examples.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/vbaliga/gaussplotR">gaussplotR</a></span>)

<span class="co">## We'll also use lattice, ggplot2 and metR</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://lattice.r-forge.r-project.org">lattice</a></span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/eliocamp/metR">metR</a></span>)

<span class="co">## Load the sample data set</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="kw">gaussplot_sample_data</span>)

<span class="co">## The raw data we'd like to use are in columns 1:3</span>
<span class="kw">samp_dat</span> <span class="op">&lt;-</span>
  <span class="kw">gaussplot_sample_data</span>[,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>]
</pre></div>
<p>It generally helps to plot the data beforehand to get a sense of its overall shape. We’ll simply produce a contour plot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">lattice</span>::<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html">levelplot</a></span>(
  <span class="kw">response</span> <span class="op">~</span> <span class="kw">X_values</span> <span class="op">*</span> <span class="kw">Y_values</span>,
  data = <span class="kw">samp_dat</span>,
  col.regions = <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"white"</span>, <span class="st">"blue"</span>)
    )(<span class="fl">100</span>),
  xlim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span>),
  ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span>), 
  asp = <span class="fl">1</span>
)
</pre></div>
<p><img src="fit_gaussian_2D_files/figure-html/raw_data_contour-1.png" width="700"></p>
</div>
<div id="the-method-and-constrain_orientation-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#the-method-and-constrain_orientation-arguments" class="anchor"></a>The <code>method</code> and <code>constrain_orientation</code> arguments</h2>
<div id="method" class="section level3">
<h3 class="hasAnchor">
<a href="#method" class="anchor"></a><code>method</code>
</h3>
<p><code><a href="../reference/fit_gaussian_2D.html">gaussplotR::fit_gaussian_2D()</a></code> has three main options for its <code>method</code> argument: 1) <code>"elliptical"</code>, 2) <code>"elliptical_log"</code>, or 3) <code>"circular"</code>.</p>
<p>The most generic method (and the default) is <code>method = "elliptical"</code>. This allows the fitted 2D Gaussian to take an ellipsoid shape. If you would like the best-fitting 2D Gaussian, this is most likely your best bet.</p>
<p>A slightly-altered method to fit an ellipsoid Gaussian is available in <code>method = "elliptical_log"</code>. This method follows Priebe et al. 2003<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and is geared towards use with log2-transformed data.</p>
<p>A third option is <code>method = "circular"</code>. This produces a very simple 2D Gaussian that is constrained to have to have a roughly circular shape (i.e. spread in X- and Y- are roughly equal).</p>
<p>An additional argument, <code>constrain_orientation</code> gives additional control over the orientation of the fitted Gaussian. By default, the <code>constrain_orientation</code> is <code>"unconstrained"</code>, meaning that the best-fit orientation is returned.</p>
</div>
<div id="constrain_orientation" class="section level3">
<h3 class="hasAnchor">
<a href="#constrain_orientation" class="anchor"></a><code>constrain_orientation</code>
</h3>
<p>Setting constrain_orientation to a numeric (e.g. <code>constrain_orientation = pi/2</code>) will force the orientation of the Gaussian to the specified value, but this is only available when using <code>method = "elliptical"</code> or <code>method = "elliptical_log"</code></p>
<p>Note that supplying a numeric to <code>constrain_orientation</code> is handled differently by <code>method = "elliptical"</code> vs <code>method = "elliptical_log"</code>. With <code>method = "elliptical"</code>, a <code>theta</code> parameter dictates the rotation, in radians, from the x-axis in the clockwise direction. Thus, using <code>method = "elliptical", constrain_orientation = pi/2</code> will return parameters for an elliptical 2D Gaussian that is constrained to a 90-degree (pi/2) orientation. In contrast, the <code>method = "elliptical_log"</code> procedure uses a <code>Q</code> parameter to determine the orientation of the 2D Gaussian. Setting <code>method = "elliptical_log", constrain_orientation = 0</code> will result in a diagonally-oriented Gaussian, whereas setting <code>constrain_orientation = -1</code> will result in horizontal orientation. Again, see Priebe et al. 2003 for more details.</p>
</div>
</div>
<div id="example-1-unconstrained-elliptical" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-unconstrained-elliptical" class="anchor"></a>Example 1: Unconstrained elliptical</h2>
<p>Unconstrained ellipticals are the default option and are generally recommended for most purposes. Here’s an example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">gauss_fit_ue</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/fit_gaussian_2D.html">fit_gaussian_2D</a></span>(<span class="kw">samp_dat</span>)

<span class="kw">gauss_fit_ue</span>
<span class="co">#&gt; $coefs</span>
<span class="co">#&gt;         A_o      Amp    theta    X_peak   Y_peak         a         b</span>
<span class="co">#&gt; 1 0.8272942 32.25132 3.581234 -2.638124 2.021262 0.9072492 0.9611345</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; Nonlinear regression model</span>
<span class="co">#&gt;   model: response ~ A_o + Amp * exp(-((((X_values - X_peak) * cos(theta) -     (Y_values - Y_peak) * sin(theta))/a)^2 + (((X_values - X_peak) *     sin(theta) - (Y_values - Y_peak) * cos(theta))/b)^2)/2)</span>
<span class="co">#&gt;    data: data</span>
<span class="co">#&gt;     A_o     Amp   theta  X_peak  Y_peak       a       b </span>
<span class="co">#&gt;  0.8273 32.2513  3.5812 -2.6381  2.0213  0.9072  0.9611 </span>
<span class="co">#&gt;  residual sum-of-squares: 156.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of iterations to convergence: 13 </span>
<span class="co">#&gt; Achieved convergence tolerance: 3.935e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model_error_stats</span>
<span class="co">#&gt;        rss     rmse deviance      AIC</span>
<span class="co">#&gt; 1 156.2272 2.083181 156.2272 171.0041</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fit_method</span>
<span class="co">#&gt;          method       amplitude     orientation </span>
<span class="co">#&gt;    "elliptical" "unconstrained" "unconstrained" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"gaussplotR")</span>
<span class="co">#&gt; [1] "gaussplotR_fit"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="kw">gauss_fit_ue</span>)
<span class="co">#&gt; $names</span>
<span class="co">#&gt; [1] "coefs"             "model"             "model_error_stats"</span>
<span class="co">#&gt; [4] "fit_method"       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $gaussplotR</span>
<span class="co">#&gt; [1] "gaussplotR_fit"</span>
</pre></div>
<p>Fitting an unconstrained ellipse returns an object (here: <code>gauss_fit_ue</code>) that is a <code>data.frame</code> with one column per fitted parameter. The fitted parameters are: <code>A_o</code> (a constant term), <code>Amp</code> (amplitude), <code>theta</code> (rotation, in radians, from the x-axis in the clockwise direction), <code>X_peak</code> (x-axis peak location), <code>Y_peak</code> (y-axis peak location), <code>a</code> (width of Gaussian along x-axis), and <code>b</code> (width of Gaussian along y-axis).</p>
<p>Note that the attribute <code>fit_method</code> indicates that an <code>"elliptical_unconstr"</code> approach was used. This attribute is used by <code><a href="../reference/predict_gaussian_2D.html">predict_gaussian_2D()</a></code> to automatically determine what method (and therefore, identity of parameters) was used and then sample points from that fitted Gaussian.</p>
<p>We can elect to sample more points from the fitted Gaussian by feeding in a grid of x- and y- values on which to predict (via <code><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid()</a></code>.</p>
<p>Then, the fitted object <code>gauss_fit_ue</code> along with the grid of points can be supplied to <code>predict_gaussian_2D</code> to sample more points from the fit, which can be useful for plotting.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co">## Generate a grid of x- and y- values on which to predict</span>
<span class="kw">grid</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(X_values = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(from = <span class="op">-</span><span class="fl">5</span>, to = <span class="fl">0</span>, by = <span class="fl">0.1</span>),
              Y_values = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(from = <span class="op">-</span><span class="fl">1</span>, to = <span class="fl">4</span>, by = <span class="fl">0.1</span>))

<span class="co">## Predict the values using predict_gaussian_2D</span>
<span class="kw">gauss_data_ue</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/predict_gaussian_2D.html">predict_gaussian_2D</a></span>(
    fit_object = <span class="kw">gauss_fit_ue</span>,
    X_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">X_values</span>,
    Y_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">Y_values</span>,
  )

<span class="co">## Plot via ggplot2 and metR</span>
<span class="fu"><a href="../reference/ggplot_gaussian_2D.html">ggplot_gaussian_2D</a></span>(<span class="kw">gauss_data_ue</span>)
</pre></div>
<p><img src="fit_gaussian_2D_files/figure-html/predict_and_plot_ue-1.png" width="700"></p>
</div>
<div id="example-2-constrained-elliptical" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-constrained-elliptical" class="anchor"></a>Example 2: Constrained elliptical</h2>
<p>As noted above, the <code>constrain_orientation</code> can be used to dictate the orientation. Please note that this will very likely result in a poorer fit, but may be useful for certain types of analyses.</p>
<p>Here we’ll force the Gaussian to be horizontally-oriented.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">gauss_fit_ce</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/fit_gaussian_2D.html">fit_gaussian_2D</a></span>(<span class="kw">samp_dat</span>, 
                    constrain_orientation = <span class="fl">0</span>)

<span class="kw">gauss_fit_ce</span>
<span class="co">#&gt; $coefs</span>
<span class="co">#&gt;        A_o      Amp theta    X_peak   Y_peak        a        b</span>
<span class="co">#&gt; 1 1.259775 24.76887     0 -2.526168 1.949814 1.199245 1.327056</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; Nonlinear regression model</span>
<span class="co">#&gt;   model: response ~ A_o + Amp * exp(-((((X_values - X_peak) * cos(constrain_orientation) -     (Y_values - Y_peak) * sin(constrain_orientation))/a)^2 +     (((X_values - X_peak) * sin(constrain_orientation) - (Y_values -         Y_peak) * cos(constrain_orientation))/b)^2)/2)</span>
<span class="co">#&gt;    data: data</span>
<span class="co">#&gt;    A_o    Amp X_peak Y_peak      a      b </span>
<span class="co">#&gt;  1.260 24.769 -2.526  1.950  1.199  1.327 </span>
<span class="co">#&gt;  residual sum-of-squares: 885.8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of iterations to convergence: 157 </span>
<span class="co">#&gt; Achieved convergence tolerance: 9.813e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model_error_stats</span>
<span class="co">#&gt;       rss     rmse deviance      AIC</span>
<span class="co">#&gt; 1 885.831 4.960486  885.831 231.4718</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fit_method</span>
<span class="co">#&gt;          method       amplitude     orientation </span>
<span class="co">#&gt;    "elliptical" "unconstrained"   "constrained" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"gaussplotR")</span>
<span class="co">#&gt; [1] "gaussplotR_fit"</span>
</pre></div>
<p>We’ll use the same grid of x- and y- points as above</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co">## Predict the values using predict_gaussian_2D</span>
<span class="kw">gauss_data_ce</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/predict_gaussian_2D.html">predict_gaussian_2D</a></span>(
    fit_object = <span class="kw">gauss_fit_ce</span>,
    X_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">X_values</span>,
    Y_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">Y_values</span>,
  )

<span class="co">## Plot via ggplot2 and metR</span>
<span class="fu"><a href="../reference/ggplot_gaussian_2D.html">ggplot_gaussian_2D</a></span>(<span class="kw">gauss_data_ce</span>)
</pre></div>
<p><img src="fit_gaussian_2D_files/figure-html/predict_and_plot_ce-1.png" width="700"></p>
</div>
<div id="example-3-unconstrained-elliptical_log" class="section level2">
<h2 class="hasAnchor">
<a href="#example-3-unconstrained-elliptical_log" class="anchor"></a>Example 3: Unconstrained elliptical_log</h2>
<p>This procedure follows the formula used in Priebe et al. 2003 and is geared towards log2-transformed data (which the example data are).</p>
<p>Parameters from this model include: <code>Amp</code> (amplitude), <code>Q</code> (orientation parameter), <code>X_peak</code> (x-axis peak location), <code>Y_peak</code> (y-axis peak location), <code>X_sig</code> (spread along x-axis), and <code>Y_sig</code> (spread along y-axis).</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">gauss_fit_uel</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/fit_gaussian_2D.html">fit_gaussian_2D</a></span>(<span class="kw">samp_dat</span>, 
                    method = <span class="st">"elliptical_log"</span>)

<span class="kw">gauss_fit_uel</span>
<span class="co">#&gt; $coefs</span>
<span class="co">#&gt;        Amp          Q    X_peak   Y_peak    X_sig    Y_sig</span>
<span class="co">#&gt; 1 32.23457 -0.1942029 -2.634429 2.007712 2.108038 1.424922</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; Nonlinear regression model</span>
<span class="co">#&gt;   model: response ~ Amp * exp(-((X_values - X_peak)^2)/(X_sig^2)) * exp(-(Y_values -     ((Q + 1) * (X_values - X_peak) + Y_peak))^2/(Y_sig^2))</span>
<span class="co">#&gt;    data: data</span>
<span class="co">#&gt;     Amp       Q  X_peak  Y_peak   X_sig   Y_sig </span>
<span class="co">#&gt; 32.2346 -0.1942 -2.6344  2.0077  2.1080  1.4249 </span>
<span class="co">#&gt;  residual sum-of-squares: 169.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of iterations to convergence: 13 </span>
<span class="co">#&gt; Achieved convergence tolerance: 5.196e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model_error_stats</span>
<span class="co">#&gt;        rss     rmse deviance      AIC</span>
<span class="co">#&gt; 1 169.8812 2.172308 169.8812 172.0205</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fit_method</span>
<span class="co">#&gt;           method        amplitude      orientation </span>
<span class="co">#&gt; "elliptical_log"  "unconstrained"  "unconstrained" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"gaussplotR")</span>
<span class="co">#&gt; [1] "gaussplotR_fit"</span>

<span class="co">## Predict the values using predict_gaussian_2D</span>
<span class="kw">gauss_data_uel</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/predict_gaussian_2D.html">predict_gaussian_2D</a></span>(
    fit_object = <span class="kw">gauss_fit_uel</span>,
    X_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">X_values</span>,
    Y_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">Y_values</span>,
  )

<span class="co">## Plot via ggplot2 and metR</span>
<span class="fu"><a href="../reference/ggplot_gaussian_2D.html">ggplot_gaussian_2D</a></span>(<span class="kw">gauss_data_uel</span>)
</pre></div>
<p><img src="fit_gaussian_2D_files/figure-html/uel-1.png" width="700"></p>
</div>
<div id="example-4-constrained-elliptical_log" class="section level2">
<h2 class="hasAnchor">
<a href="#example-4-constrained-elliptical_log" class="anchor"></a>Example 4: Constrained elliptical_log</h2>
<p>Similar to the above, but here the <code>constrain_orientation</code> can be used to dictate the value of the <code>Q</code> parameter used in Priebe et al. 2003. Setting <code>Q</code> to 0 will result in a diagonally-oriented Gaussian, whereas setting <code>Q</code> to -1 will result in horizontal orientation. <code>Q</code> is a continuous parameter, so values in between may be used as well, such as in this example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">gauss_fit_cel</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/fit_gaussian_2D.html">fit_gaussian_2D</a></span>(
      <span class="kw">samp_dat</span>,
      method = <span class="st">"elliptical_log"</span>,
      constrain_orientation = <span class="op">-</span><span class="fl">0.66</span>
    )

<span class="kw">gauss_fit_cel</span>
<span class="co">#&gt; $coefs</span>
<span class="co">#&gt;        Amp     Q    X_peak   Y_peak    X_sig    Y_sig</span>
<span class="co">#&gt; 1 40.37259 -0.66 -2.603592 2.055755 1.853229 1.245801</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; Nonlinear regression model</span>
<span class="co">#&gt;   model: response ~ Amp * exp(-((X_values - X_peak)^2)/(X_sig^2)) * exp(-(Y_values -     ((constrain_orientation + 1) * (X_values - X_peak) + Y_peak))^2/(Y_sig^2))</span>
<span class="co">#&gt;    data: data</span>
<span class="co">#&gt;    Amp X_peak Y_peak  X_sig  Y_sig </span>
<span class="co">#&gt; 40.373 -2.604  2.056  1.853  1.246 </span>
<span class="co">#&gt;  residual sum-of-squares: 406.1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of iterations to convergence: 14 </span>
<span class="co">#&gt; Achieved convergence tolerance: 4.714e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model_error_stats</span>
<span class="co">#&gt;        rss     rmse deviance      AIC</span>
<span class="co">#&gt; 1 406.1011 3.358658 406.1011 201.3946</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fit_method</span>
<span class="co">#&gt;           method        amplitude      orientation </span>
<span class="co">#&gt; "elliptical_log"  "unconstrained"    "constrained" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"gaussplotR")</span>
<span class="co">#&gt; [1] "gaussplotR_fit"</span>

<span class="co">## Predict the values using predict_gaussian_2D</span>
<span class="kw">gauss_data_cel</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/predict_gaussian_2D.html">predict_gaussian_2D</a></span>(
    fit_object = <span class="kw">gauss_fit_cel</span>,
    X_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">X_values</span>,
    Y_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">Y_values</span>,
  )

<span class="co">## Plot via ggplot2 and metR</span>
<span class="fu"><a href="../reference/ggplot_gaussian_2D.html">ggplot_gaussian_2D</a></span>(<span class="kw">gauss_data_cel</span>)
</pre></div>
<p><img src="fit_gaussian_2D_files/figure-html/cel-1.png" width="700"></p>
<p>Again, setting the value of <code>Q</code> via <code>constrain_orientation</code> will very likely result in poorer-fitting Gaussians. See the analyses in Priebe et al. 2003 to get a sense of useful applications of this approach. Forcing Q = -0.66 in the above example isn’t all that useful, but goes to show that it can be done.</p>
</div>
<div id="example-5-circular" class="section level2">
<h2 class="hasAnchor">
<a href="#example-5-circular" class="anchor"></a>Example 5: Circular</h2>
<p>Using <code>method = "circular"</code> constrains the Gaussian to have a roughly circular shape (i.e. spread in X- and Y- are roughly equal).</p>
<p>If this method is used, the fitted parameters are: <code>Amp</code> (amplitude), <code>X_peak</code> (x-axis peak location), <code>Y_peak</code> (y-axis peak location), <code>X_sig</code> (spread along x-axis), and <code>Y_sig</code>(spread along y-axis).</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">gauss_fit_cir</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/fit_gaussian_2D.html">fit_gaussian_2D</a></span>(<span class="kw">samp_dat</span>, 
                    method = <span class="st">"circular"</span>)

<span class="kw">gauss_fit_cir</span>
<span class="co">#&gt; $coefs</span>
<span class="co">#&gt;        Amp    X_peak   Y_peak    X_sig    Y_sig</span>
<span class="co">#&gt; 1 23.18005 -2.546643 1.811152 1.316288 1.642641</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; Nonlinear regression model</span>
<span class="co">#&gt;   model: response ~ Amp * exp(-((((X_values - X_peak)^2)/(2 * X_sig^2) +     ((Y_values - Y_peak)^2)/(2 * Y_sig^2))))</span>
<span class="co">#&gt;    data: data</span>
<span class="co">#&gt;    Amp X_peak Y_peak  X_sig  Y_sig </span>
<span class="co">#&gt; 23.180 -2.547  1.811  1.316  1.643 </span>
<span class="co">#&gt;  residual sum-of-squares: 899.6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of iterations to convergence: 22 </span>
<span class="co">#&gt; Achieved convergence tolerance: 9.057e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model_error_stats</span>
<span class="co">#&gt;       rss     rmse deviance      AIC</span>
<span class="co">#&gt; 1 899.613 4.998925  899.613 230.0276</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fit_method</span>
<span class="co">#&gt;          method       amplitude     orientation </span>
<span class="co">#&gt;      "circular" "unconstrained"              NA </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"gaussplotR")</span>
<span class="co">#&gt; [1] "gaussplotR_fit"</span>

<span class="co">## Predict the values using predict_gaussian_2D</span>
<span class="kw">gauss_data_cir</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/predict_gaussian_2D.html">predict_gaussian_2D</a></span>(
    fit_object = <span class="kw">gauss_fit_cir</span>,
    X_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">X_values</span>,
    Y_values = <span class="kw">grid</span><span class="op">$</span><span class="kw">Y_values</span>,
  )

<span class="co">## Plot via ggplot2 and metR</span>
<span class="fu"><a href="../reference/ggplot_gaussian_2D.html">ggplot_gaussian_2D</a></span>(<span class="kw">gauss_data_cir</span>)
</pre></div>
<p><img src="fit_gaussian_2D_files/figure-html/cir-1.png" width="700"></p>
<p>That’s all!</p>
<p>🐢</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Priebe NJ, Cassanello CR, Lisberger SG. The neural representation of speed in macaque area MT/V5. J Neurosci. 2003 Jul 2;23(13):5650-61. doi: 10.1523/JNEUROSCI.23-13-05650.2003.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.vikram-baliga.com/">Vikram B. Baliga</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
